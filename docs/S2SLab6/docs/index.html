<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>S2S Lab 6</title>
  <meta name="description" content="S2S Lab 6" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="S2S Lab 6" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="S2S Lab 6" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="sampling-distribution-for-bar-x---bar-y.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Sampling Distribution of <span class="math inline">\(\bar{X}\)</span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#central-limit-theorem"><i class="fa fa-check"></i><b>1.1</b> Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sampling-distribution-for-bar-x---bar-y.html"><a href="sampling-distribution-for-bar-x---bar-y.html"><i class="fa fa-check"></i><b>2</b> Sampling distribution for <span class="math inline">\(\bar X - \bar Y\)</span></a></li>
<li class="chapter" data-level="3" data-path="further-exercises.html"><a href="further-exercises.html"><i class="fa fa-check"></i><b>3</b> Further Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="further-exercises.html"><a href="further-exercises.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="further-exercises.html"><a href="further-exercises.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">S2S Lab 6</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">S2S Lab 6</h1>
</div>
<div id="sampling-distribution-of-barx" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Sampling Distribution of <span class="math inline">\(\bar{X}\)</span><a href="index.html#sampling-distribution-of-barx" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Suppose we were to take multiple random samples, each of the same size, from a distribution. We would be able to calculate the mean of each sample, or sample mean, and be left with many different values of <span class="math inline">\(\bar X\)</span>. The distribution of all of these sample means is called the sampling distribution of <span class="math inline">\(\bar X\)</span>.</p>
<div id="central-limit-theorem" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Central Limit Theorem<a href="index.html#central-limit-theorem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An important result regarding the sampling distribution of <span class="math inline">\(\bar X\)</span> is that, provided the sample size is sufficiently large, the sampling distribution of <span class="math inline">\(\bar X\)</span> will follow a normal distribution. For this to be true, the random variable <span class="math inline">\(X\)</span> <em>does not need to follow a normal distribution</em> itself. This result is know as the <strong>Central Limit Theorem</strong>.</p>
<p>Formally, for a random variable <span class="math inline">\(X\)</span> which follows <em>any</em> distribution with known mean, <span class="math inline">\(\mu\)</span>, and standard deviation, <span class="math inline">\(\sigma\)</span>, then</p>
<p><span class="math display">\[
Z=\frac{\bar X-\mu}{\frac{\sigma}{\sqrt{n}}}\sim N(0,\, 1)
\]</span>
as <span class="math inline">\(n\rightarrow\infty\)</span>.</p>
<p>This can be rephrased to say that the sampling distribution of <span class="math inline">\(\bar X\)</span> is approximately <span class="math inline">\(N\Big(\mu,\,\frac{\sigma}{\sqrt{n}}\Big)\)</span>, provided the size of the sample taken, <span class="math inline">\(n\)</span>, is sufficiently large.</p>
<p>This term <em>sufficiently large</em> should make you wonder, how big does a sample need to be to be considered sufficiently large? This actually depends on the distribution that the random variable <span class="math inline">\(X\)</span> follows.</p>
<p>Let's look at an example of sampling from different distributions to determine how big a sample we need for the sampling distribution of <span class="math inline">\(\bar X\)</span> to be considered normal. Specifically, we will sample from the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> and <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distributions. Note that both these distributions have mean and standard deviation approximately equal to 15 - you should try and show this yourself!</p>
<div class="webex-box webex-check">
<p><strong>If we were to take samples of size <span class="math inline">\(n=2\)</span> from the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> distribution, what distribution would <span class="math inline">\(\bar X\)</span> follow, according to the Central Limit Theorem?</strong></p>
<div id="radio_KEIXVYKCIM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KEIXVYKCIM" value="answer"></input> <span><span class="math inline">\(N\Big(15,\,\textstyle\frac{15}{\sqrt{2}}\Big)\)</span></span></label><label><input type="radio" autocomplete="off" name="radio_KEIXVYKCIM" value=""></input> <span><span class="math inline">\(N\Big(-11,\,\textstyle\frac{41}{\sqrt{2}}\Big)\)</span></span></label><label><input type="radio" autocomplete="off" name="radio_KEIXVYKCIM" value=""></input> <span><span class="math inline">\(\mbox{Unif}\Big(-11,\,41\Big)\)</span></span></label><label><input type="radio" autocomplete="off" name="radio_KEIXVYKCIM" value=""></input> <span><span class="math inline">\(N\Big(15,\,15\Big)\)</span></span></label>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<p>If <span class="math inline">\(X\sim\mbox{Unif}(-11,\, 41)\)</span>, then we can show that,</p>
<ul>
<li><span class="math inline">\(E[X]=15=\mu\)</span></li>
<li><span class="math inline">\(sd(X)\approx 15=\sigma\)</span></li>
</ul>
<p>We can then use these values to show that, according to the Central Limit Theorem,</p>
<p><span class="math display">\[
\bar X\sim N\Big(15,\,\textstyle\frac{15}{\sqrt{2}}\Big)
\]</span></p>
</div>
</div>
<div class="webex-box webex-check">
<p><strong>If we were to take samples of size <span class="math inline">\(n=2\)</span> from the <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distribution, what distribution would <span class="math inline">\(\bar X\)</span> follow, according to the Central Limit Theorem?</strong></p>
<div id="radio_XHVCSEDXTL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XHVCSEDXTL" value=""></input> <span><span class="math inline">\(N\Big(\textstyle\frac{1}{15},\,\textstyle\frac{15}{\sqrt{2}}\Big)\)</span></span></label><label><input type="radio" autocomplete="off" name="radio_XHVCSEDXTL" value="answer"></input> <span><span class="math inline">\(N\Big(15,\,\textstyle\frac{15}{\sqrt{2}}\Big)\)</span></span></label><label><input type="radio" autocomplete="off" name="radio_XHVCSEDXTL" value=""></input> <span><span class="math inline">\(N\Big(15,\,15\Big)\)</span></span></label><label><input type="radio" autocomplete="off" name="radio_XHVCSEDXTL" value=""></input> <span><span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span></span></label>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<p>If <span class="math inline">\(X\sim \mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span>, then we can show that,</p>
<ul>
<li><span class="math inline">\(E[X]=15=\mu\)</span></li>
<li><span class="math inline">\(sd(X)=15=\sigma\)</span></li>
</ul>
<p>We can then use these values to show that, according to the Central Limit Theorem,</p>
<p><span class="math display">\[
\bar X\sim N\Big(15,\,\textstyle\frac{15}{\sqrt{2}}\Big)
\]</span></p>
</div>
</div>
<p>To see if the sampling distribution of <span class="math inline">\(\bar X\)</span> is indeed normal, with mean <span class="math inline">\(\mu=15\)</span> and standard deviation <span class="math inline">\(\sigma=\textstyle\frac{15}{\sqrt{2}}\)</span>, we want to draw <span class="math inline">\(m=10,000\)</span> random samples of size <span class="math inline">\(n=2\)</span> from both the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> and <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distributions and use these samples to calculate 10,000 values of the mean, <span class="math inline">\(\bar x\)</span>. We can then plot the distribution of these sample means and compare it to the <span class="math inline">\(N\Big(15,\,\textstyle\frac{15}{\sqrt{2}}\Big)\)</span> distribution for both cases.</p>
<p>To start with, let's set up two empty vectors, <code>means_unif_2</code> and <code>means_expo_2</code>, which will be used to store each of the 10,000 means calculated from samples taken from the Uniform and Exponential distributions respectively. This is done using the function <code>numeric()</code> which creates an empty vector with length equal to the value you provide as the argument, in this case <code>m</code> = 10,000.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="index.html#cb1-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-2"><a href="index.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="index.html#cb1-3" tabindex="-1"></a>means_unif_2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb1-4"><a href="index.html#cb1-4" tabindex="-1"></a>means_expo_2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span></code></pre></div>
<p>To draw the samples from each distribution and calculate the mean, a for loop is used. For the Uniform distribution, <code>runif()</code> is used to draw a random sample of size <span class="math inline">\(n=2\)</span> from the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> distribution, and then the function <code>mean()</code> is used to calculate the mean of these two values. The for loop stores this mean as one of the values in the vector <code>means_unif_2</code>, and repeats until 10,000 random samples have been drawn and used to calculate a mean.</p>
<p>The same process is used to draw the samples from the Exponential distribution, except the function <code>rexp()</code> is used to draw the random samples (for more details on probability functions, refer to Lab 3).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="index.html#cb2-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb2-2"><a href="index.html#cb2-2" tabindex="-1"></a>  means_unif_2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">11</span>, <span class="at">max =</span> <span class="dv">41</span>))</span>
<span id="cb2-3"><a href="index.html#cb2-3" tabindex="-1"></a>}</span>
<span id="cb2-4"><a href="index.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="index.html#cb2-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb2-6"><a href="index.html#cb2-6" tabindex="-1"></a>  means_expo_2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rexp</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>))</span>
<span id="cb2-7"><a href="index.html#cb2-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Before we can plot either of these sampling distributions using <code>ggplot2</code>, the sample means need to be stored within a data frame. The following code creates the data frame, <code>means_2</code>, which has a column storing the value of the mean calculated for each sample, and a second column stating which distribution this sample mean was from.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="index.html#cb3-1" tabindex="-1"></a>means_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">c</span>(means_unif_2, means_expo_2),</span>
<span id="cb3-2"><a href="index.html#cb3-2" tabindex="-1"></a>                      <span class="at">distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Uniform&quot;</span>, <span class="st">&quot;Exponential&quot;</span>), <span class="at">each =</span> m))</span>
<span id="cb3-3"><a href="index.html#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="index.html#cb3-4" tabindex="-1"></a>means_2<span class="sc">$</span>distribution <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> means_2<span class="sc">$</span>distribution,</span>
<span id="cb3-5"><a href="index.html#cb3-5" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Uniform&quot;</span>, <span class="st">&quot;Exponential&quot;</span>))</span>
<span id="cb3-6"><a href="index.html#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="index.html#cb3-7" tabindex="-1"></a><span class="fu">head</span>(means_2)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">mean</th>
<th align="left">distribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15.717109</td>
<td align="left">Uniform</td>
</tr>
<tr class="even">
<td align="right">25.693907</td>
<td align="left">Uniform</td>
</tr>
<tr class="odd">
<td align="right">26.798285</td>
<td align="left">Uniform</td>
</tr>
<tr class="even">
<td align="right">3.354951</td>
<td align="left">Uniform</td>
</tr>
<tr class="odd">
<td align="right">23.204408</td>
<td align="left">Uniform</td>
</tr>
<tr class="even">
<td align="right">26.569319</td>
<td align="left">Uniform</td>
</tr>
</tbody>
</table>
</div>
<p>Now, we are ready to plot the two sampling distributions of <span class="math inline">\(\bar X\)</span> from the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> and <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distributions. This is done using <code>ggplot2</code> in the following code.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="index.html#cb4-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> means_2) <span class="sc">+</span></span>
<span id="cb4-2"><a href="index.html#cb4-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean), <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-3"><a href="index.html#cb4-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(distribution <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb4-4"><a href="index.html#cb4-4" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>, <span class="dv">41</span>)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="index.html#cb4-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sample size n = 2&quot;</span>,</span>
<span id="cb4-6"><a href="index.html#cb4-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(x)), <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-7"><a href="index.html#cb4-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">15</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>)), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb4-8"><a href="index.html#cb4-8" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>)</span></code></pre></div>
<p>Let's take a look at each layer in turn.</p>
<ul>
<li><code>geom_density()</code>: this tells <code>ggplot2</code> that we want to create a kernel density estimate of the means stored within the data frame <code>means_2</code>, along the x-axis.</li>
<li><code>facet_grid()</code>: because <code>means_2</code> stores the means for samples taken from both the Uniform and Exponential distributions, we want two different plots of the sampling distribution of <span class="math inline">\(\bar X\)</span> from each. Here we specify that we want each row of plots to be for a different distribution.</li>
<li><code>coord_cartesian()</code>: we can specify the range of values we want to show along the x-axis and limit this range to a sensible one to show the full scope of each distribution.</li>
<li><code>labs()</code>: this allows us to give the plots some axes labels and a title.</li>
<li><code>stat_function()</code>: this superimposes a defined function above the density plots already created. According to the Central Limit Theorem, the sampling distribution of <span class="math inline">\(\bar X\)</span> from both the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> and <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distributions should be approximately <span class="math inline">\(N\Big(15, \textstyle\frac{15}{\sqrt{2}}\Big)\)</span> when the sample size is <span class="math inline">\(n=2\)</span>, so this is the distribution we want to show.</li>
</ul>
<p>Using <code>stat_function()</code> as a layer in a <code>ggplot2</code> plot allows you to draw any defined function above the rest of the figure. This is useful when you want to include plots of data which are not from the data frame provided in the <code>data =</code> argument of the <code>ggplot()</code> function. The arguments that <code>stat_function()</code> can be supplied with are:</p>
<ul>
<li><code>fun =</code>: this is the name of the function in R that will calculate the values to be plotted against different values along the x-axis. If you wish to plot a probability distribution, then use the name of the function that calculates the corresponding values of the probability density function (PDF) e.g. for the normal distribution, use <code>dnorm</code>, or for the exponential distribution, use <code>dexp</code>.</li>
<li><code>args =</code>: this is a list of all the argument values to be provided the R function named in the <code>fun =</code> argument. Different functions will require different arguments, so check that the ones you provide make sense with the function you've stated in the <code>fun =</code> argument.</li>
<li><code>geom =</code>: this is the name of the geometric object you want to use to show the data. Examples include <code>"area"</code> to plot the area under the curve, <code>"point"</code> to plot points representing the value at different points along the x-axis, or <code>"polygon"</code> to plot the area between the minimum value along the x-axis, the maximum value and the area under the curve.</li>
<li><code>col =</code>: this is the colour to use for the line on the plot representing the function.</li>
<li><code>linetype =</code>: this is an integer value indicating which style of line you would like to plot.</li>
<li><code>fill =</code>: this is the colour to be used to fill in the area under the curve. In order for this to be used, the argument `geom</li>
<li><code>alpha =</code>: this sets the opacity of the fill colour. You can set this argument to be any value between 0 and 1 - a value of 1 means the colour will be fully opaque and a value of 0 means the colour will be transparent.</li>
</ul>
<p>The code above produces the following two plots.</p>
<p><img src="_main_files/figure-html/samp4.2-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="webex-box webex-check">
<p><strong>Do you think the the sampling distribution of <span class="math inline">\(\bar X\)</span>, when samples of size <span class="math inline">\(n=2\)</span> are taken from the <span class="math inline">\(\mbox{Unif}(-11,\,41)\)</span> distribution, is approximately normal?</strong></p>
<p><select class='webex-select'><option value='blank'></option><option value='answer'>Yes</option><option value=''>No</option><option value=''>Can't say</option></select></p>
</div>
<div class="webex-box webex-check">
<p><strong>What about the sampling distribution of <span class="math inline">\(\bar X\)</span> when samples of size <span class="math inline">\(n=2\)</span> are taken from the <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distribution - is it approximately normal?</strong></p>
<p><select class='webex-select'><option value='blank'></option><option value=''>Yes</option><option value='answer'>No</option><option value=''>Can't say</option></select></p>
</div>
<p>It seems that a sample size of <span class="math inline">\(n=2\)</span> is not <em>sufficiently large</em> to give a sampling distribution of <span class="math inline">\(\bar X\)</span> which follows the normal distribution, when we are sampling from the Exponential distribution. In order for the Central Limit Theorem to hold true then, we need to take larger samples from the <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distribution.</p>
<p>Let's take samples of size <span class="math inline">\(n=10\)</span> and <span class="math inline">\(n=40\)</span> from both the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> and <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distributions, to investigate how the sample size affects the sampling distribution of <span class="math inline">\(\bar X\)</span>.</p>
<p>In the code below, we take 10,000 random samples of size <span class="math inline">\(n=10\)</span> from the Uniform and Exponential distributions and then save the mean of each sample in either the vector <code>means_unif_10</code>, if the sample was taken from the Uniform distribution, or <code>means_expo_10</code>, if the sample was from the Exponential distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="index.html#cb5-1" tabindex="-1"></a>means_unif_10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb5-2"><a href="index.html#cb5-2" tabindex="-1"></a>means_expo_10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb5-3"><a href="index.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="index.html#cb5-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb5-5"><a href="index.html#cb5-5" tabindex="-1"></a>  means_unif_10[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">11</span>, <span class="at">max =</span> <span class="dv">41</span>))</span>
<span id="cb5-6"><a href="index.html#cb5-6" tabindex="-1"></a>}</span>
<span id="cb5-7"><a href="index.html#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="index.html#cb5-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb5-9"><a href="index.html#cb5-9" tabindex="-1"></a>  means_expo_10[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rexp</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>))</span>
<span id="cb5-10"><a href="index.html#cb5-10" tabindex="-1"></a>}</span></code></pre></div>
<p>Similarly, we can take samples of size <span class="math inline">\(n=40\)</span> from each distribution and save the mean of each sample in a vector using the following code.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="index.html#cb6-1" tabindex="-1"></a>means_unif_40 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb6-2"><a href="index.html#cb6-2" tabindex="-1"></a>means_expo_40 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb6-3"><a href="index.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="index.html#cb6-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb6-5"><a href="index.html#cb6-5" tabindex="-1"></a>  means_unif_40[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">11</span>, <span class="at">max =</span> <span class="dv">41</span>))</span>
<span id="cb6-6"><a href="index.html#cb6-6" tabindex="-1"></a>}</span>
<span id="cb6-7"><a href="index.html#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="index.html#cb6-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb6-9"><a href="index.html#cb6-9" tabindex="-1"></a>  means_expo_40[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rexp</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>))</span>
<span id="cb6-10"><a href="index.html#cb6-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="webex-box webex-check">
<p><strong>Complete the code below to draw 10,000 samples of size <span class="math inline">\(n=100\)</span> from the <span class="math inline">\(\mbox{Unif}(-11,\,41)\)</span> distribution, and another 10,000 samples of size <span class="math inline">\(n=100\)</span> from the <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distribution.</strong></p>
<div class="webex-code">
<pre><code> means_unif_100 &lt;- numeric(m)
 means_expo_100 &lt;- numeric(m)</code></pre>
<ul style="margin-top:1.2em; margin-left:-1em;">
<code>for( i in</code><input class='webex-solveme nospaces' size='7' data-answer='["1:m","1:10000"]'/><code>){</code>
</ul>
<ul style="margin-top:-0.8em; margin-left:0.2em;">
<code>means_unif_100[</code><input class='webex-solveme nospaces' size='1' data-answer='["i"]'/><code>] &lt;- mean(</code><select class='webex-select'><option value='blank'></option><option value=''>rexp</option><option value='answer'>runif</option><option value=''>rnorm</option><option value=''>rpois</option></select><code>(n =</code><input class='webex-solveme nospaces' size='3' data-answer='["100"]'/><code>, min = -11, max = 41))</code>
</ul>
<ul style="margin-top:-0.8em; margin-left:-1em;">
<code>}</code>
</ul>
<ul style="margin-top:1.2em; margin-left:-1em;">
<code>for( i in</code><input class='webex-solveme nospaces' size='7' data-answer='["1:m","1:10000"]'/><code>){</code>
</ul>
<ul style="margin-top:-0.8em; margin-left:0.2em;">
<code>means_expo_100[</code><input class='webex-solveme nospaces' size='1' data-answer='["i"]'/><code>] &lt;- mean(</code><select class='webex-select'><option value='blank'></option><option value='answer'>rexp</option><option value=''>runif</option><option value=''>rnorm</option><option value=''>rpois</option></select><code>(n =</code><input class='webex-solveme nospaces' size='3' data-answer='["100"]'/><code>, rate =</code><input class='webex-solveme nospaces' size='8' data-answer='["1/15","0.067","0.0667","0.06667","0.066667"]'/><code>))</code>
</ul>
<ul style="margin-top:-0.8em; margin-left:-1em;">
<code>}</code>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="index.html#cb8-1" tabindex="-1"></a>means_unif_100 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb8-2"><a href="index.html#cb8-2" tabindex="-1"></a>means_expo_100 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb8-3"><a href="index.html#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="index.html#cb8-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb8-5"><a href="index.html#cb8-5" tabindex="-1"></a>  means_unif_100[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">11</span>, <span class="at">max =</span> <span class="dv">41</span>))</span>
<span id="cb8-6"><a href="index.html#cb8-6" tabindex="-1"></a>}</span>
<span id="cb8-7"><a href="index.html#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="index.html#cb8-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb8-9"><a href="index.html#cb8-9" tabindex="-1"></a>  means_expo_100[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rexp</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>))</span>
<span id="cb8-10"><a href="index.html#cb8-10" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<p>Now that we have all of the sample means saved in various vectors, we will need to compile them all into a data frame in order for us to be able to plot their respective distributions using <code>ggplot2</code>. The code below creates the data frame <code>means</code>, which stores each sample mean, along with the distribution the sample was taken from and the size of the sample.</p>
<p>Note that we are including the sample means from the samples of size <span class="math inline">\(n=2\)</span> in this data frame for completeness.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="index.html#cb9-1" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">c</span>(means_unif_2, means_expo_2,</span>
<span id="cb9-2"><a href="index.html#cb9-2" tabindex="-1"></a>                             means_unif_10, means_expo_10,</span>
<span id="cb9-3"><a href="index.html#cb9-3" tabindex="-1"></a>                             means_unif_40, means_expo_40,</span>
<span id="cb9-4"><a href="index.html#cb9-4" tabindex="-1"></a>                             means_unif_100, means_expo_100),</span>
<span id="cb9-5"><a href="index.html#cb9-5" tabindex="-1"></a>                    <span class="at">distribution =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Uniform&quot;</span>, <span class="st">&quot;Exponential&quot;</span>), <span class="at">each =</span> m),</span>
<span id="cb9-6"><a href="index.html#cb9-6" tabindex="-1"></a>                                       <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb9-7"><a href="index.html#cb9-7" tabindex="-1"></a>                    <span class="at">size =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;n = 2&quot;</span>, <span class="st">&quot;n = 10&quot;</span>, <span class="st">&quot;n = 40&quot;</span>, <span class="st">&quot;n = 100&quot;</span>), <span class="at">each =</span> <span class="dv">2</span><span class="sc">*</span>m))</span>
<span id="cb9-8"><a href="index.html#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="index.html#cb9-9" tabindex="-1"></a>means<span class="sc">$</span>distribution <span class="ot">&lt;-</span> <span class="fu">factor</span>(means<span class="sc">$</span>distribution, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Uniform&quot;</span>, <span class="st">&quot;Exponential&quot;</span>))</span>
<span id="cb9-10"><a href="index.html#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="index.html#cb9-11" tabindex="-1"></a>means<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">factor</span>(means<span class="sc">$</span>size, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;n = 2&quot;</span>, <span class="st">&quot;n = 10&quot;</span>, <span class="st">&quot;n = 40&quot;</span>, <span class="st">&quot;n = 100&quot;</span>))</span></code></pre></div>
<p>We can then plot the two sampling distributions of <span class="math inline">\(\bar X\)</span> from the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> and <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distributions when the sample size is <span class="math inline">\(n=10\)</span> using the code below. We have to subset the data from <code>means</code> to show only the means which are from a sample size of <span class="math inline">\(n=10\)</span>. Also, because the sample size has changed, the distribution that the Central Limit Theorem states <span class="math inline">\(\bar X\)</span> will follow in both cases is now <span class="math inline">\(N\Big(15,\,\textstyle\frac{15}{\sqrt{10}}\Big)\)</span>, so this is the distribution we want to superimpose using <code>stat_function()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="index.html#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(means, <span class="at">subset =</span> (size <span class="sc">==</span> <span class="st">&quot;n = 10&quot;</span>))) <span class="sc">+</span></span>
<span id="cb10-2"><a href="index.html#cb10-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean), <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="index.html#cb10-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(distribution <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb10-4"><a href="index.html#cb10-4" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">31</span>)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="index.html#cb10-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sample size n = 10&quot;</span>,</span>
<span id="cb10-6"><a href="index.html#cb10-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(x)), <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="index.html#cb10-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">15</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span>)), <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb10-8"><a href="index.html#cb10-8" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/samp8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can also show the sampling distributions of <span class="math inline">\(\bar X\)</span> from the Uniform and Exponential distributions when the sample size is <span class="math inline">\(n=40\)</span>. This done using the code below. Again, note that the distribution the Central Limit Theorem states the sampling distribution of <span class="math inline">\(\bar X\)</span> will follow is now <span class="math inline">\(N\Big(15,\,\textstyle\frac{15}{\sqrt{40}}\Big)\)</span> because the sample size has changed.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="index.html#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(means, <span class="at">subset =</span> (size <span class="sc">==</span> <span class="st">&quot;n = 40&quot;</span>))) <span class="sc">+</span></span>
<span id="cb11-2"><a href="index.html#cb11-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean), <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="index.html#cb11-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(distribution <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb11-4"><a href="index.html#cb11-4" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="index.html#cb11-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sample size n = 40&quot;</span>,</span>
<span id="cb11-6"><a href="index.html#cb11-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(x)), <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="index.html#cb11-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">15</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">40</span>)), <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb11-8"><a href="index.html#cb11-8" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/samp9-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="webex-box webex-check">
<p><strong>Complete the code below to plot the sampling distribution of <span class="math inline">\(\bar X\)</span> for the samples of size <span class="math inline">\(n=100\)</span> taken from the <span class="math inline">\(\mbox{Unif}(-11,\, 41)\)</span> and <span class="math inline">\(\mbox{Expo}\Big(\textstyle\frac{1}{15}\Big)\)</span> distributions. Superimpose the normal distribution that each sampling distribution follows according to the Central Limit Theorem.</strong></p>
<div class="webex-code">
<pre><code> ggplot(data = subset(means, subset = (size == &quot;n = 100&quot;))) +
 </code></pre>
<ul style="margin-top:-3.6em; margin-left:0.6em;">
<select class='webex-select'><option value='blank'></option><option value=''>geom_dens</option><option value='answer'>geom_density</option><option value=''>density</option></select><code>(aes(x = mean), fill = "skyblue") +</code>
</ul>
<ul style="margin-top:-0.8em; margin-left:0.2em;">
<code>facet_grid(</code><input class='webex-solveme nospaces' size='16' data-answer='["distribution ~ ."]'/><code>) +</code>
</ul>
<ul style="margin-top:-1.6em; margin-left:-0.8em;">
<pre><code> coord_cartesian(xlim = c(9, 21)) +
 labs(title = &quot;Sample size n = 100&quot;,
      x = expression(bar(x)), y = &quot;Density&quot;) +</code></pre>
</ul>
<ul style="margin-top:-2em; margin-left:0.2em;">
<code>stat_function(fun = dnorm, args = list(mean =</code><input class='webex-solveme nospaces' size='2' data-answer='["15"]'/><code>, sd =</code><input class='webex-solveme nospaces' size='12' data-answer='["15/sqrt(100)","1.5"]'/><code>),</code>
</ul>
<ul style="margin-top:-0.8em; margin-left:7.6em;">
<code>geom =</code><input class='webex-solveme nospaces' size='6' data-answer='["\"area\""]'/><code>, col = "black", linetype = 2, fill = "black",</code>
</ul>
<ul style="margin-top:-0.8em; margin-left:7.6em;">
<code>alpha = 0.2)</code>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="index.html#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(means, <span class="at">subset =</span> (size <span class="sc">==</span> <span class="st">&quot;n = 100&quot;</span>))) <span class="sc">+</span></span>
<span id="cb14-2"><a href="index.html#cb14-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean), <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="index.html#cb14-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(distribution <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb14-4"><a href="index.html#cb14-4" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="index.html#cb14-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sample size n = 100&quot;</span>,</span>
<span id="cb14-6"><a href="index.html#cb14-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(x)), <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="index.html#cb14-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">15</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">100</span>)),</span>
<span id="cb14-8"><a href="index.html#cb14-8" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb14-9"><a href="index.html#cb14-9" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/samp-ans2-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<hr />
<p>Section <a href="https://read.kortext.com/reader/pdf/92741/370">6.5.1.2 Second Case: Sampling Distribution of <span class="math inline">\(\bar X\)</span> When <span class="math inline">\(X\)</span> Is Not a Normal Random Variable</a> of <em>Probability and Statistics with R</em> details a similar example of finding the distribution of <span class="math inline">\(\bar X\)</span> through sampling.</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Check Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Check Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>

<a href="sampling-distribution-for-bar-x---bar-y.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
