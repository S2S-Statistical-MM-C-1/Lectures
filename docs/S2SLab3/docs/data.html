<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Working With Data | S2S Lab 3</title>
  <meta name="description" content="3 Working With Data | S2S Lab 3" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Working With Data | S2S Lab 3" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Working With Data | S2S Lab 3" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reading.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome!</a></li>
<li class="chapter" data-level="2" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>2</b> Reading in Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading.html"><a href="reading.html#directory"><i class="fa fa-check"></i><b>2.1</b> Setting your working directory</a></li>
<li class="chapter" data-level="2.2" data-path="reading.html"><a href="reading.html#read.table"><i class="fa fa-check"></i><b>2.2</b> <code>read.table()</code></a></li>
<li class="chapter" data-level="2.3" data-path="reading.html"><a href="reading.html#read.csv"><i class="fa fa-check"></i><b>2.3</b> <code>read.csv()</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Working With Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#checking"><i class="fa fa-check"></i><b>3.1</b> Checking variable types</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#dealing-with-na-values"><i class="fa fa-check"></i><b>3.2</b> Dealing with <code>NA</code> values</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#sorting-data-frames"><i class="fa fa-check"></i><b>3.3</b> Sorting data frames</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#subsetting"><i class="fa fa-check"></i><b>3.4</b> Subsetting</a></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#summarising-data"><i class="fa fa-check"></i><b>3.5</b> Summarising data</a></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#creating-variables"><i class="fa fa-check"></i><b>3.6</b> Creating variables</a></li>
<li class="chapter" data-level="3.7" data-path="data.html"><a href="data.html#merging-data-frames"><i class="fa fa-check"></i><b>3.7</b> Merging data frames</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#probability-functions"><i class="fa fa-check"></i><b>4.1</b> Probability functions</a></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#flow-control"><i class="fa fa-check"></i><b>4.2</b> Flow control</a></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#creating-functions"><i class="fa fa-check"></i><b>4.3</b> Creating functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>5</b> Further Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">S2S Lab 3</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Working With Data<a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="checking" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Checking variable types<a href="data.html#checking" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once a data frame has been read into R, it is always a good idea to examine its contents using the <code>str()</code> function to see the <strong>structure</strong> of the data object. We have already seen the <code>str()</code> function in <a href="https://s2s-statistical-mm-c-1.github.io/Labs/S2SLab2Live/docs/data.html#df">Lab 2</a> but as a reminder, it shows us the type of vector each column in a data frame is saved as.</p>
<p>Running the following code tells us that the four variables <code>ldl</code>, <code>hdl</code>, <code>trig</code> and <code>age</code> are all integer vectors and that <code>id</code>, <code>gender</code> and <code>smoke</code> are character vectors.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data.html#cb3-1" tabindex="-1"></a><span class="fu">str</span>(chol)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   13 obs. of  7 variables:
 $ id    : chr  &quot;P912&quot; &quot;P215&quot; &quot;P063&quot; &quot;P117&quot; ...
 $ ldl   : int  175 196 139 162 140 147 82 165 149 95 ...
 $ hdl   : int  25 36 65 37 117 51 81 63 49 54 ...
 $ trig  : int  148 92 NA 139 59 126 NA 120 NA 157 ...
 $ age   : int  39 32 42 30 42 65 57 48 32 55 ...
 $ gender: chr  &quot;female&quot; &quot;female&quot; &quot;male&quot; &quot;female&quot; ...
 $ smoke : chr  &quot;no&quot; &quot;no&quot; NA &quot;ex-smoker&quot; ...</code></pre>
<p>Because <code>gender</code> only takes the values <code>"female"</code> or <code>"male"</code> in this case, and <code>smoke</code> is categorised into three levels, <code>"no"</code>, <code>"ex-smoker"</code> and <code>"current"</code>, it makes sense to treat both these variables as factors instead of character vectors.</p>
<p>We can use what we learned in <a href="https://s2s-statistical-mm-c-1.github.io/Labs/S2SLab2Live/docs/data.html#fact">Lab 2</a> to change these variables into factors.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data.html#cb5-1" tabindex="-1"></a>chol<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> chol<span class="sc">$</span>gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>))</span>
<span id="cb5-2"><a href="data.html#cb5-2" tabindex="-1"></a>chol<span class="sc">$</span>smoke <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> chol<span class="sc">$</span>smoke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;ex-smoker&quot;</span>, <span class="st">&quot;current&quot;</span>))</span></code></pre></div>
<p>Now using <code>str()</code> to check the type of vector each column is saved as shows us that <code>gender</code> and <code>smoke</code> are both now factors.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data.html#cb6-1" tabindex="-1"></a><span class="fu">str</span>(chol)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   13 obs. of  7 variables:
 $ id    : chr  &quot;P912&quot; &quot;P215&quot; &quot;P063&quot; &quot;P117&quot; ...
 $ ldl   : int  175 196 139 162 140 147 82 165 149 95 ...
 $ hdl   : int  25 36 65 37 117 51 81 63 49 54 ...
 $ trig  : int  148 92 NA 139 59 126 NA 120 NA 157 ...
 $ age   : int  39 32 42 30 42 65 57 48 32 55 ...
 $ gender: Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 1 2 1 1 1 2 2 1 1 ...
 $ smoke : Factor w/ 3 levels &quot;no&quot;,&quot;ex-smoker&quot;,..: 1 1 NA 2 2 2 1 3 1 2 ...</code></pre>
<div class="webex-box webex-check">
<p><strong>What type of variable is <code>schools</code> saved as in the <code>education</code> data frame?</strong>
<select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>logical</option><option value=''>numeric</option><option value='answer'>integer</option><option value=''>factor</option></select></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>Using the <code>str()</code> function shows us that <code>schools</code> is saved as an integer variable.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data.html#cb8-1" tabindex="-1"></a><span class="fu">str</span>(education)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   21 obs. of  5 variables:
 $ year    : int  2016 2016 2016 2017 2017 2017 2018 2018 2018 2019 ...
 $ level   : chr  &quot;ELC&quot; &quot;Primary&quot; &quot;Secondary&quot; &quot;ELC&quot; ...
 $ schools : int  2514 2031 359 2532 2019 360 2544 2012 357 2576 ...
 $ teachers: int  985 23920 22957 921 24477 23150 821 NA 23317 798 ...
 $ pupils  : int  96961 396697 280983 95893 400312 281993 96549 400276 286152 96375 ...</code></pre>
</div>
</div>
<div class="webex-box">
<p><strong>Write some code to change the variables <code>year</code> and <code>level</code> in <code>education</code> to be factor variables.</strong></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data.html#cb10-1" tabindex="-1"></a>education<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> education<span class="sc">$</span>year,</span>
<span id="cb10-2"><a href="data.html#cb10-2" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;2016&quot;</span>, <span class="st">&quot;2017&quot;</span>, <span class="st">&quot;2018&quot;</span>, <span class="st">&quot;2019&quot;</span>,</span>
<span id="cb10-3"><a href="data.html#cb10-3" tabindex="-1"></a>                                    <span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>))</span>
<span id="cb10-4"><a href="data.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="data.html#cb10-5" tabindex="-1"></a>education<span class="sc">$</span>level <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> education<span class="sc">$</span>level,</span>
<span id="cb10-6"><a href="data.html#cb10-6" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;ELC&quot;</span>, <span class="st">&quot;Primary&quot;</span>, <span class="st">&quot;Secondary&quot;</span>))</span></code></pre></div>
</div>
</div>
<hr />
<p>Refer to <a href="https://read.kortext.com/reader/pdf/92741/47">Section 1.11 Working with Data</a> of <em>Probability and Statistics with R</em> to learn more about checking the setup of a data set.</p>
</div>
<div id="dealing-with-na-values" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Dealing with <code>NA</code> values<a href="data.html#dealing-with-na-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data sets will often have missing values for a variety of different reasons; maybe because of human error, maybe because information was not disclosed or maybe because of a failed experiment for example. When data is correctly read into R these unknown values will be denoted by <code>NA</code>. In order to conduct analysis or perform calculations on your data, you may wish to remove these missing values from your data set. <strong>Always think about whether this is an appropriate thing to do.</strong></p>
<p>One way in which we can remove missing values from a data set is to use the function <code>na.omit()</code>. This will return the data frame with any 'incomplete cases' removed. That is, any rows that have <code>NA</code> as the value for any variable will be removed from the data frame.</p>
<p>Looking at <code>chol</code>, we can see that there are missing values in rows 3, 7 and 9.</p>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
P063
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
P951
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
P004
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
P725
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
P901
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
P103
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
P753
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
current
</td>
</tr>
</tbody>
</table>
</div>
<p>If we run the following code, then these rows are removed from the data frame and we are left with only the 'complete cases'.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data.html#cb11-1" tabindex="-1"></a><span class="fu">na.omit</span>(chol)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
P004
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
P901
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
P103
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
P753
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
current
</td>
</tr>
</tbody>
</table>
</div>
<p>Note that <code>na.omit()</code> preserves the original row labels. This means that there are no rows labelled 3, 7 or 9 in the resulting data frame because they have been completely removed.</p>
<p><code>complete.cases()</code> is another useful function that can be used to remove rows that have <code>NA</code> values. This returns a logical vector, the same length as the number of rows of the data frame, that indicates whether a row contains any <code>NA</code> values (<code>FALSE</code>), or whether it is 'complete' (<code>TRUE</code>).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data.html#cb12-1" tabindex="-1"></a><span class="fu">complete.cases</span>(chol)</span></code></pre></div>
<pre><code> [1]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE
[13]  TRUE</code></pre>
<p>Again we can see that the rows with missing values in <code>chol</code> are rows 3, 7 and 9 (since the third, seventh and ninth values in the output above are all <code>FALSE</code>). We can then use this logical vector to extract the rows which are complete from <code>chol</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data.html#cb14-1" tabindex="-1"></a>chol[<span class="fu">complete.cases</span>(chol), ]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
P004
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
P901
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
P103
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
P753
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
current
</td>
</tr>
</tbody>
</table>
</div>
<p>Here, using <code>na.omit()</code> and <code>complete.cases()</code> have returned the same output.</p>
<div class="webex-box webex-check">
<p><strong>Which rows in <code>education</code> have missing values?</strong>
<select class='webex-select'><option value='blank'></option><option value=''>none</option><option value=''>8 only</option><option value=''>8 and 15</option><option value='answer'>8 and 16</option><option value=''>16 only</option></select></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>Using <code>complete.cases()</code> shows us that rows 8 and 16 of <code>education</code> are incomplete and therefore contain <code>NA</code> values.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data.html#cb15-1" tabindex="-1"></a><span class="fu">complete.cases</span>(education)</span></code></pre></div>
<pre><code> [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
[13]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
</div>
</div>
<div class="webex-box webex-check">
<p><strong>Write code to remove all rows in <code>education</code> which contain <code>NA</code> values.</strong></p>
<div class="webex-code">
<p><input class='webex-solveme nospaces' size='39' data-answer='["education[complete.cases(education), ]","na.omit(education)","education[!is.na(education$teachers), ]"]'/></p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<p>Incomplete observations can be removed from <code>education</code> using any of the following lines of code.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data.html#cb17-1" tabindex="-1"></a><span class="fu">na.omit</span>(education)</span>
<span id="cb17-2"><a href="data.html#cb17-2" tabindex="-1"></a>education[<span class="fu">complete.cases</span>(education), ]</span>
<span id="cb17-3"><a href="data.html#cb17-3" tabindex="-1"></a>education[<span class="sc">!</span><span class="fu">is.na</span>(education<span class="sc">$</span>teachers), ]</span></code></pre></div>
</div>
</div>
<p>In the case where we only want to know which entries of a vector or specific variable in a data frame are <code>NA</code>, we can use the function <code>is.na()</code>. For example, if missing values in the <code>trig</code> variable were not of concern but we wanted to identify missing values in the <code>smoke</code> column, we could use the following code.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data.html#cb18-1" tabindex="-1"></a><span class="fu">is.na</span>(chol<span class="sc">$</span>smoke)</span></code></pre></div>
<pre><code> [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[13] FALSE</code></pre>
<p>We can see that only the third row has the value <code>NA</code> for <code>smoke</code>, since the third element in the output from <code>is.na()</code> above is <code>TRUE</code>. In order to remove the row where <code>smoke</code> has a missing value, we can use the following code to index the <code>chol</code> data frame.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data.html#cb20-1" tabindex="-1"></a>chol[<span class="sc">!</span><span class="fu">is.na</span>(chol<span class="sc">$</span>smoke), ]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
P951
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
P004
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
P725
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
P901
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
P103
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
P753
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
current
</td>
</tr>
</tbody>
</table>
</div>
<p>Note that we use <code>!</code> in front of <code>is.na()</code> so that the logical vector returned has the value <code>TRUE</code> when values are complete and <code>FALSE</code> when values are missing i.e. <code>NA</code>.</p>
<hr />
<p>You can look at further examples of dealing with missing data in <a href="https://read.kortext.com/reader/pdf/92741/51">Section 1.11.1 Dealing with <code>NA</code> Values</a> of <em>Probability and Statistics with R</em>.</p>
</div>
<div id="sorting-data-frames" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Sorting data frames<a href="data.html#sorting-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When investigating your data sets, you may want to order the values of a particular variable in increasing or decreasing order. This is easily done using the <code>sort()</code> function.</p>
<p>For example, we can view the ages of all subjects in <code>chol</code>, in increasing order, using the code below.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data.html#cb21-1" tabindex="-1"></a><span class="fu">sort</span>(chol<span class="sc">$</span>age)</span></code></pre></div>
<pre><code> [1] 30 32 32 39 41 42 42 48 48 55 57 65 69</code></pre>
<p>Note that if we wanted to view these ages in decreasing order, we would add the argument <code>decreasing = TRUE</code> to the <code>sort()</code> function.</p>
<div class="webex-box webex-check">
<p><strong>What is the largest value for <code>pupils</code> from the <code>education</code> data frame?</strong>
<input class='webex-solveme nospaces' size='7' data-answer='["400312","400,312"]'/></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data.html#cb23-1" tabindex="-1"></a><span class="fu">sort</span>(education<span class="sc">$</span>pupils, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>[1] 400312</code></pre>
</div>
</div>
<p>The downside of using <code>sort()</code> is that we can only see the values from one variable of a data frame. If instead we wanted to order all subjects in <code>chol</code> from the youngest to the oldest and still see the values of all the other variables, we can use the function <code>order()</code>.</p>
<p><code>order()</code> will return a vector showing which row has the smallest value, then the second smallest value and so on. For example, the following code shows us that the fourth subject in <code>chol</code> is the youngest and the thirteenth subject is the eldest.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data.html#cb25-1" tabindex="-1"></a><span class="fu">order</span>(chol<span class="sc">$</span>age)</span></code></pre></div>
<pre><code> [1]  4  2  9  1 12  3  5  8 11 10  7  6 13</code></pre>
<p>We can then use this vector to index the full data frame <code>chol</code> and see all the variables for each subject at once.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data.html#cb27-1" tabindex="-1"></a>chol[<span class="fu">order</span>(chol<span class="sc">$</span>age), ]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
P725
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
P063
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
P004
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
P103
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
P901
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
P951
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
P753
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
current
</td>
</tr>
</tbody>
</table>
</div>
<p>In the output above, note that there are multiple subjects aged 32, 42 and 48. After ordering by <code>age</code>, R automatically shows these subjects with the same age in order of increasing row number. We could however add a second or third argument to <code>order()</code> to order the rows by another variable in the case where there are repeated values of the first variable.</p>
<p>For example, the following code orders all the subjects in <code>chol</code> by <code>age</code> first, and then for any subjects that are the same age, they will then be sorted in order of increasing <code>ldl</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data.html#cb28-1" tabindex="-1"></a>chol[<span class="fu">order</span>(chol<span class="sc">$</span>age, chol<span class="sc">$</span>ldl), ]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
P725
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
P063
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
P004
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
P103
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
P901
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
P951
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
P753
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
current
</td>
</tr>
</tbody>
</table>
</div>
<div class="webex-box">
<p><strong>Write code to sort the observations from <code>education</code> in decreasing order of the number of pupils.</strong></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>We need to include the argument <code>decreasing = TRUE</code> within the function <code>order()</code> so that the observations are ordered from largest number of pupils to the smallest number of pupils. We can use the <code>order()</code> function within square brackets to show all variables in the data frame in order of decreasing number of pupils.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data.html#cb29-1" tabindex="-1"></a>education[<span class="fu">order</span>(education<span class="sc">$</span>pupils, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
schools
</th>
<th style="text-align:right;">
teachers
</th>
<th style="text-align:right;">
pupils
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;">
24477
</td>
<td style="text-align:right;">
400312
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
2018
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
400276
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
25027
</td>
<td style="text-align:right;">
398794
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2016
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2031
</td>
<td style="text-align:right;">
23920
</td>
<td style="text-align:right;">
396697
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
25651
</td>
<td style="text-align:right;">
393957
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
2021
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
25807
</td>
<td style="text-align:right;">
390313
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
2022
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
1994
</td>
<td style="text-align:right;">
25451
</td>
<td style="text-align:right;">
388920
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
2022
</td>
<td style="text-align:left;">
Secondary
</td>
<td style="text-align:right;">
358
</td>
<td style="text-align:right;">
24874
</td>
<td style="text-align:right;">
309133
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
2021
</td>
<td style="text-align:left;">
Secondary
</td>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
24782
</td>
<td style="text-align:right;">
306811
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
Secondary
</td>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
24077
</td>
<td style="text-align:right;">
300954
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
Secondary
</td>
<td style="text-align:right;">
358
</td>
<td style="text-align:right;">
23522
</td>
<td style="text-align:right;">
292063
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
2018
</td>
<td style="text-align:left;">
Secondary
</td>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
23317
</td>
<td style="text-align:right;">
286152
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
Secondary
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
23150
</td>
<td style="text-align:right;">
281993
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2016
</td>
<td style="text-align:left;">
Secondary
</td>
<td style="text-align:right;">
359
</td>
<td style="text-align:right;">
22957
</td>
<td style="text-align:right;">
280983
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2016
</td>
<td style="text-align:left;">
ELC
</td>
<td style="text-align:right;">
2514
</td>
<td style="text-align:right;">
985
</td>
<td style="text-align:right;">
96961
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
2018
</td>
<td style="text-align:left;">
ELC
</td>
<td style="text-align:right;">
2544
</td>
<td style="text-align:right;">
821
</td>
<td style="text-align:right;">
96549
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
ELC
</td>
<td style="text-align:right;">
2576
</td>
<td style="text-align:right;">
798
</td>
<td style="text-align:right;">
96375
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
ELC
</td>
<td style="text-align:right;">
2532
</td>
<td style="text-align:right;">
921
</td>
<td style="text-align:right;">
95893
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
2022
</td>
<td style="text-align:left;">
ELC
</td>
<td style="text-align:right;">
2606
</td>
<td style="text-align:right;">
734
</td>
<td style="text-align:right;">
92615
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
2021
</td>
<td style="text-align:left;">
ELC
</td>
<td style="text-align:right;">
2630
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
91603
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
ELC
</td>
<td style="text-align:right;">
2587
</td>
<td style="text-align:right;">
729
</td>
<td style="text-align:right;">
90126
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr />
<p>Look at <a href="https://read.kortext.com/reader/pdf/92741/55">Section 1.11.3 Sorting a Data Frame by One or More of Its Columns</a> of <em>Probability and Statistics with R</em> to learn more about sorting and ordering data sets.</p>
</div>
<div id="subsetting" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Subsetting<a href="data.html#subsetting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we want to only view particular elements of a data frame, this is known as subsetting the data. This is useful if you're dealing with extremely large data sets and only want to analyse female subjects, or subjects who are all from the same country for example. Subsetting the data means that you would extract only these subjects that you are actually interested in.</p>
<p>A useful function for extracting elements of a data frame is the function <code>subset()</code> (which we first saw in Lab 1). This allows us to extract the elements of a data frame which meet particular conditions. The arguments that <code>subset()</code> takes are:</p>
<ul>
<li><code>x =</code>: this is the data frame that we want to extract particular elements from.</li>
<li><code>subset =</code>: this is a logical statement which determines the elements to keep in the subsetted data frame.</li>
<li><code>select =</code>: this shows the column or columns from the data frame which the logical statement should be applied to.</li>
</ul>
<p>For example, if we wanted to view the subjects in <code>chol</code> who have an LDL of greater than 170, then we can use the following code.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data.html#cb30-1" tabindex="-1"></a><span class="fu">subset</span>(<span class="at">x =</span> chol, <span class="at">subset =</span> ldl <span class="sc">&gt;</span> <span class="dv">170</span>, <span class="at">select =</span> ldl)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
ldl
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
175
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
196
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
174
</td>
</tr>
</tbody>
</table>
</div>
<p>This shows us that there are three patients with LDL greater than 170 (<code>subset = ldl &gt; 170</code>) and we can also see the values of LDL for these patients (<code>select = ldl</code>).</p>
<p>If we wanted to see the values of the other variables in the data frame for only those patients with LDL greater than 170, then we can simply leave out the <code>select =</code> argument.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data.html#cb31-1" tabindex="-1"></a><span class="fu">subset</span>(<span class="at">x =</span> chol, <span class="at">subset =</span> ldl <span class="sc">&gt;</span> <span class="dv">170</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
</tbody>
</table>
</div>
<p>Note that it is also possible to subset a data frame using logical statements within square brackets, <code>[ ]</code>. We could return the same output as above by indexing the <code>chol</code> using the following code.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data.html#cb32-1" tabindex="-1"></a>chol[chol<span class="sc">$</span>ldl <span class="sc">&gt;</span> <span class="dv">170</span>, ]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
</tr>
</tbody>
</table>
</div>
<div class="webex-box">
<p><strong>Write some code to subset <code>education</code> to show the number of schools that have a collective total of more than 310,000 pupils in the years 2020, 2021 or 2022.</strong></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>The data frame that we want to subset is <code>education</code>, so this is what we'll feed in to the argument <code>x =</code>.</p>
<p>Since the question asks us to look for a collective total of more than 310,000 pupils, this means we want to only see the rows where the value for <code>pupils</code> is greater than 310,000. We also only want to see rows from the years 2020, 2021 or 2022. Because <code>year</code> is a factor, we need to specify each level that we are interested in. This means that we are looking for rows in which <code>pupils &gt; 310000</code> AND <code>year == "2020"</code> or <code>year == "2021"</code> or <code>year == "2021"</code>. This is quite a lengthy logical statement in the following code.</p>
<p>The question also asks us to only show the number of schools for which these statements are true i.e. the column <code>schools</code>. To do this, we simply feed this variable to the <code>select =</code> argument.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data.html#cb33-1" tabindex="-1"></a><span class="fu">subset</span>(<span class="at">x =</span> education,</span>
<span id="cb33-2"><a href="data.html#cb33-2" tabindex="-1"></a>       <span class="at">subset =</span> pupils <span class="sc">&gt;</span> <span class="dv">310000</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="st">&quot;2020&quot;</span> <span class="sc">|</span> </span>
<span id="cb33-3"><a href="data.html#cb33-3" tabindex="-1"></a>         pupils <span class="sc">&gt;</span> <span class="dv">310000</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="st">&quot;2021&quot;</span> <span class="sc">|</span> </span>
<span id="cb33-4"><a href="data.html#cb33-4" tabindex="-1"></a>         pupils <span class="sc">&gt;</span> <span class="dv">310000</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="st">&quot;2022&quot;</span>,</span>
<span id="cb33-5"><a href="data.html#cb33-5" tabindex="-1"></a>       <span class="at">select =</span> schools)</span></code></pre></div>
<p>A way we can shorten the logical statement in the <code>subset =</code> argument is to use the operator <code>%in%</code>. This will search for values in a vector and return the rows in which any of these values appear.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data.html#cb34-1" tabindex="-1"></a><span class="fu">subset</span>(<span class="at">x =</span> education,</span>
<span id="cb34-2"><a href="data.html#cb34-2" tabindex="-1"></a>       <span class="at">subset =</span> pupils <span class="sc">&gt;</span> <span class="dv">310000</span> <span class="sc">&amp;</span> year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>),</span>
<span id="cb34-3"><a href="data.html#cb34-3" tabindex="-1"></a>       <span class="at">select =</span> schools)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
schools
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
2005
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
2001
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:right;">
1994
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr />
<p>You can read more about subsetting data frames in <a href="https://read.kortext.com/reader/pdf/92741/58">Section 1.12 Using Logical Operators with Data Frames</a> in <em>Probability and Statistics with R</em>.</p>
</div>
<div id="summarising-data" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Summarising data<a href="data.html#summarising-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data sets will often contain a lot of information which is not easy to interpret at a glance. It is therefore useful to be able to summarise the data they contain, in appropriate ways for each different type of variable.</p>
<p>One of the simplest functions to help summarise a data frame is the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data.html#cb35-1" tabindex="-1"></a><span class="fu">summary</span>(chol)</span></code></pre></div>
<pre><code>      id                 ldl             hdl           trig      
 Length:13          Min.   : 82.0   Min.   : 25   Min.   : 59.0  
 Class :character   1st Qu.:139.0   1st Qu.: 49   1st Qu.: 99.0  
 Mode  :character   Median :149.0   Median : 54   Median :132.5  
                    Mean   :144.9   Mean   : 62   Mean   :122.2  
                    3rd Qu.:169.0   3rd Qu.: 65   3rd Qu.:147.5  
                    Max.   :196.0   Max.   :117   Max.   :168.0  
                                                  NA&#39;s   :3      
      age           gender         smoke  
 Min.   :30.00   female:10   no       :6  
 1st Qu.:39.00   male  : 3   ex-smoker:4  
 Median :42.00               current  :2  
 Mean   :46.15               NA&#39;s     :1  
 3rd Qu.:55.00                            
 Max.   :69.00                            
                                          </code></pre>
<p>The output from <code>summary()</code> shows information for each column in the data frame you provide as the argument. For numerical variables, we are shown summary statistics such as the minimum value, the mean or the 3rd quartile. For factor variables, we are shown how many observations there are in each level of the factor. If there are any <code>NA</code> values in a column, the total number of these will also be shown for each variable.</p>
<p>When a data frame contains categorical variables, a neater way to summarise the counts of the different levels is in contingency tables. These show counts of how many times each level of a categorical variable appeared in the data frame. The function to create contingency tables in R is <code>table()</code>. The only argument that <code>table()</code> needs is the factor variable you want to summarise.</p>
<p>For example, we can quickly show counts of how many subjects in <code>chol</code> fall into each of the three levels of the <code>smoke</code> variable using the following code.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data.html#cb37-1" tabindex="-1"></a><span class="fu">table</span>(chol<span class="sc">$</span>smoke)</span></code></pre></div>
<pre><code>
       no ex-smoker   current 
        6         4         2 </code></pre>
<p>If we wanted to further split these counts by the variable <code>gender</code>, then we simply add this as a second argument to the <code>table()</code> function.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data.html#cb39-1" tabindex="-1"></a>smoke_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(chol<span class="sc">$</span>smoke, chol<span class="sc">$</span>gender)</span>
<span id="cb39-2"><a href="data.html#cb39-2" tabindex="-1"></a>smoke_counts</span></code></pre></div>
<pre><code>           
            female male
  no             5    1
  ex-smoker      4    0
  current        1    1</code></pre>
<p>We can easily compute the sums of rows or columns in a table using the function <code>margin.table()</code>. Here we need to provide <code>margin.table()</code> with the following arguments:</p>
<ul>
<li><code>x =</code>: this is the table you want to sum over.</li>
<li><code>margin =</code>: this tells R whether you want to sum over rows (set the value to 1), or columns (set the value to 2).</li>
</ul>
<p>For example, we can use the table <code>smoke_counts</code>, created above, to count the number of female and male subjects for whom we know their smoking status, using <code>margin.table()</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data.html#cb41-1" tabindex="-1"></a><span class="fu">margin.table</span>(<span class="at">x =</span> smoke_counts, <span class="at">margin =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>
female   male 
    10      2 </code></pre>
<p>Another useful function to use with tables is <code>prop.table()</code>. This takes the same arguments as <code>margin.table()</code> but shows row or column proportions, rather than sums.</p>
<p>For example, to calculate the proportions of current smokers, ex-smokers and non-smokers that are female and male, we can use the following code.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data.html#cb43-1" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="at">x =</span> smoke_counts, <span class="at">margin =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>           
               female      male
  no        0.8333333 0.1666667
  ex-smoker 1.0000000 0.0000000
  current   0.5000000 0.5000000</code></pre>
<p>Suppose you wanted to calculate summary statistics for one variable in a data frame, but have it split by the levels of a different categorical variable.</p>
<p>The function in R which calculates a summary statistic for one numeric variable, split by the levels of a factor is <code>tapply()</code>. The arguments that <code>tapply()</code> can take are as follows:</p>
<ul>
<li><code>X =</code>: this is the numeric variable that you want to apply the function calculating some summary statistic to.</li>
<li><code>INDEX =</code>: this is a <strong>list</strong> containing the categorical variable (or variables) you want to split the calculation of the summary statistic across.</li>
<li><code>FUN =</code>: this is the name of the function you want to apply to the numeric variable. Examples include <code>mean</code>, <code>median</code>, <code>max</code>, <code>min</code>, <code>mode</code>, <code>sd</code> etc.</li>
</ul>
<p>In the case where we are interested in knowing the mean HDL for subjects who were current smokers, subjects who were ex-smokers and subjects who were non-smokers, we can use <code>tapply()</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data.html#cb45-1" tabindex="-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> chol<span class="sc">$</span>hdl, <span class="at">INDEX =</span> <span class="fu">list</span>(chol<span class="sc">$</span>smoke), <span class="at">FUN =</span> mean)</span></code></pre></div>
<pre><code>       no ex-smoker   current 
 61.16667  64.75000  57.50000 </code></pre>
<p>We can see, for example, that the mean HDL for non-smokers is 61.17. <!--units?--></p>
<p>The list provided to the <code>INDEX =</code> argument can contain more than one categorical variable. For example, we can calculate the mean HDL of females and males for each level of the <code>smoke</code> variable using the following code.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data.html#cb47-1" tabindex="-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> chol<span class="sc">$</span>hdl, <span class="at">INDEX =</span> <span class="fu">list</span>(chol<span class="sc">$</span>smoke, chol<span class="sc">$</span>gender), <span class="at">FUN =</span> mean)</span></code></pre></div>
<pre><code>          female male
no         57.20   81
ex-smoker  64.75   NA
current    52.00   63</code></pre>
<p>Now we can see that the mean HDL for females who are non-smokers is 57.20. <!-- units--> The mean HDL for males who are ex-smokers is <code>NA</code> because there are no males included in <code>chol</code> who are ex-smokers.</p>
<div class="webex-box webex-check">
<p><strong>What is the mean total number of teachers in primary schools across all years?</strong>
<input class='webex-solveme nospaces' size='10' data-answer='["25055","25056","25055.5","25055.50","25055.500","25055.5000"]'/></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>In order to find this value we want to use the function <code>tapply()</code>. <code>teachers</code> is the column we want to calculate the <code>mean</code> for, but make sure to split this by the different levels in the <code>level</code> column.</p>
<p><code>teachers</code> contains some <code>NA</code> values, which when passed to the function <code>mean</code> will return another <code>NA</code> value unless you provide to <code>tapply()</code> the additional argument <code>na.rm = TRUE</code>. This tells R to ignore the <code>NA</code> values when calculating the mean and only use those rows which have a numerical value.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data.html#cb49-1" tabindex="-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> education<span class="sc">$</span>teachers, <span class="at">INDEX =</span> <span class="fu">list</span>(education<span class="sc">$</span>level), <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>       ELC    Primary  Secondary 
  831.3333 25055.5000 23811.2857 </code></pre>
</div>
</div>
<hr />
<p>To read more on creating tables and summarising data in R, see Sections <a href="https://read.kortext.com/reader/pdf/92741/62">1.13 Tables</a> and <a href="https://read.kortext.com/reader/pdf/92741/66">1.14 Summarizing Functions</a> in <em>Probability and Statistics with R</em>.</p>
</div>
<div id="creating-variables" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Creating variables<a href="data.html#creating-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the case where we have another vector or data frame that we wish to join to an existing one, we can do this using one of the functions <code>cbind()</code> or <code>rbind()</code>.</p>
<ul>
<li><p><code>cbind()</code> combines the vectors or data frames together by making additional columns, whereas</p></li>
<li><p><code>rbind()</code> combines them by adding the new vector or data frame as additional rows.</p></li>
</ul>
<p>Let's see an example to understand how this works. The file <em>measurements.csv</em> contains information on the heights and weights of all 13 patients in the original <code>chol</code> data frame. We can begin by reading it in to the <strong>Environment</strong> tab using the following code.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data.html#cb51-1" tabindex="-1"></a>measurements <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;measurements.csv&quot;</span>)</span></code></pre></div>
<p>We can then add <code>measurements</code> to <code>chol</code> as two additional columns and save the resulting data frame as <code>chol_full</code> using the code below.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="data.html#cb52-1" tabindex="-1"></a>chol_full <span class="ot">&lt;-</span> <span class="fu">cbind</span>(chol, measurements)</span>
<span id="cb52-2"><a href="data.html#cb52-2" tabindex="-1"></a><span class="fu">head</span>(chol_full)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
height
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
90.77
</td>
<td style="text-align:right;">
1.69
</td>
</tr>
<tr>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
75.06
</td>
<td style="text-align:right;">
1.75
</td>
</tr>
<tr>
<td style="text-align:left;">
P063
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
73.99
</td>
<td style="text-align:right;">
1.84
</td>
</tr>
<tr>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
86.25
</td>
<td style="text-align:right;">
1.83
</td>
</tr>
<tr>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
76.95
</td>
<td style="text-align:right;">
1.81
</td>
</tr>
<tr>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
57.66
</td>
<td style="text-align:right;">
1.75
</td>
</tr>
</tbody>
</table>
</div>
<p>Another way to easily create a new variable in a data frame is to use the <code>$</code> operator. We can simply add the name of the data frame to the left of <code>$</code> and our new variable name to the right. Then we can set this variable to be any pre-existing vector, or calculate a new vector based on variables from the data frame.</p>
<p>For example, if we wanted to create a new variable, <code>bmi</code>, in <code>chol</code> which shows the BMI of each patient, then we can use the following code.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data.html#cb53-1" tabindex="-1"></a>chol_full<span class="sc">$</span>bmi <span class="ot">&lt;-</span> chol_full<span class="sc">$</span>weight<span class="sc">/</span>(chol_full<span class="sc">$</span>height)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-2"><a href="data.html#cb53-2" tabindex="-1"></a><span class="fu">head</span>(chol_full)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
height
</th>
<th style="text-align:right;">
bmi
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
90.77
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
31.78110
</td>
</tr>
<tr>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
75.06
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:right;">
24.50939
</td>
</tr>
<tr>
<td style="text-align:left;">
P063
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
73.99
</td>
<td style="text-align:right;">
1.84
</td>
<td style="text-align:right;">
21.85432
</td>
</tr>
<tr>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
86.25
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:right;">
25.75473
</td>
</tr>
<tr>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
76.95
</td>
<td style="text-align:right;">
1.81
</td>
<td style="text-align:right;">
23.48829
</td>
</tr>
<tr>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
57.66
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:right;">
18.82776
</td>
</tr>
</tbody>
</table>
</div>
<div class="webex-box">
<p><strong>In the <code>education</code> data frame, create a new variable called <code>ratio</code> which calculates the pupil to teacher ratio in each level of education. That is,</strong></p>
<p><span class="math display">\[\mbox{ratio}=\textstyle\frac{\mbox{puils}}{\mbox{teachers}}\]</span></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="data.html#cb54-1" tabindex="-1"></a>education<span class="sc">$</span>ratio <span class="ot">&lt;-</span> education<span class="sc">$</span>pupils<span class="sc">/</span>education<span class="sc">$</span>teachers</span></code></pre></div>
</div>
</div>
<p>Now suppose that information on a fourteenth subject is known but has not been included in the original <code>chol</code> data frame. This data is shown in Table <a href="data.html#tab:subject-table">3.1</a> below.</p>
<table>
<caption>
<span id="tab:subject-table">Table 3.1: </span>Cholesterol data for the fourteenth patient.
</caption>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
ldl
</th>
<th style="text-align:left;">
hdl
</th>
<th style="text-align:left;">
trig
</th>
<th style="text-align:left;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
<th style="text-align:left;">
weight
</th>
<th style="text-align:left;">
height
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P461
</td>
<td style="text-align:left;">
148
</td>
<td style="text-align:left;">
78
</td>
<td style="text-align:left;">
120
</td>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
<td style="text-align:left;">
84.05
</td>
<td style="text-align:left;">
1.79
</td>
</tr>
</tbody>
</table>
<p>In this case we can add the new subject as an additional row using the <code>rbind()</code> function.</p>
<p>First, we need to create a data frame containing the information for this subject. In order for us to add this data frame as a row to <code>chol_full</code>, it needs to have the same number of variables. Therefore, we also need to calculate the BMI for this subject and call it <code>bmi</code>. We can do all this with the following code.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data.html#cb55-1" tabindex="-1"></a>subject <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="st">&quot;P461&quot;</span>, <span class="at">ldl =</span> <span class="dv">148</span>, <span class="at">hdl =</span> <span class="dv">78</span>, <span class="at">trig =</span> <span class="dv">120</span>, <span class="at">age =</span> <span class="dv">41</span>, </span>
<span id="cb55-2"><a href="data.html#cb55-2" tabindex="-1"></a>                      <span class="at">gender =</span> <span class="st">&quot;male&quot;</span>, <span class="at">smoke =</span> <span class="st">&quot;current&quot;</span>, <span class="at">weight =</span> <span class="fl">84.05</span>, <span class="at">height =</span> <span class="fl">1.79</span>)</span>
<span id="cb55-3"><a href="data.html#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="data.html#cb55-4" tabindex="-1"></a>subject<span class="sc">$</span>bmi <span class="ot">&lt;-</span> subject<span class="sc">$</span>weight<span class="sc">/</span>(subject<span class="sc">$</span>height)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>Now we can add this subject to <code>chol_full</code> using the code below.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="data.html#cb56-1" tabindex="-1"></a>chol_full <span class="ot">&lt;-</span> <span class="fu">rbind</span>(chol_full, subject)</span>
<span id="cb56-2"><a href="data.html#cb56-2" tabindex="-1"></a><span class="fu">tail</span>(chol_full)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
height
</th>
<th style="text-align:right;">
bmi
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
P725
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
65.37
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
23.43935
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
P901
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
80.34
</td>
<td style="text-align:right;">
1.62
</td>
<td style="text-align:right;">
30.61271
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
P103
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
74.90
</td>
<td style="text-align:right;">
1.61
</td>
<td style="text-align:right;">
28.89549
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
P843
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
63.78
</td>
<td style="text-align:right;">
1.77
</td>
<td style="text-align:right;">
20.35813
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
P753
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
current
</td>
<td style="text-align:right;">
71.58
</td>
<td style="text-align:right;">
1.62
</td>
<td style="text-align:right;">
27.27481
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
P461
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
<td style="text-align:right;">
84.05
</td>
<td style="text-align:right;">
1.79
</td>
<td style="text-align:right;">
26.23202
</td>
</tr>
</tbody>
</table>
</div>
<p>Note that <code>tail()</code> is a function very similar to <code>head()</code>, but rather than showing the first 6 rows by default, it shows the last 6.</p>
<p>For numeric variables in a data frame, it can sometimes be useful to split the values into intervals and create a new factor with numerical levels. For example, if we wanted to identify high, mid and low levels of <code>hdl</code> in <code>chol_full</code>.</p>
<p>The function that can do this in R is <code>cut()</code>. The arguments that <code>cut()</code> takes are:</p>
<ul>
<li><code>x =</code>: this is the numeric variable that you want to split into different levels.</li>
<li><code>breaks =</code>: this is the number of levels you want to split the numeric vector into.</li>
<li><code>include.lowest =</code>: this takes the values <code>TRUE</code> or <code>FALSE</code>, indicating whether the lowest value in the numeric variable should be included in the first level. By default this is set to <code>FALSE</code> so this smallest value is not included.</li>
</ul>
<p>We can split <code>hdl</code> into three levels using the following code.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data.html#cb57-1" tabindex="-1"></a><span class="fu">cut</span>(<span class="at">x =</span> chol_full<span class="sc">$</span>hdl, <span class="at">breaks =</span> <span class="dv">3</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code> [1] [24.9,55.7] [24.9,55.7] (55.7,86.3] [24.9,55.7] (86.3,117]  [24.9,55.7]
 [7] (55.7,86.3] (55.7,86.3] [24.9,55.7] [24.9,55.7] (55.7,86.3] (86.3,117] 
[13] [24.9,55.7] (55.7,86.3]
Levels: [24.9,55.7] (55.7,86.3] (86.3,117]</code></pre>
<p>This tells us that the lowest level is the range [24.9, 55.7], the middle level is (55.7, 86.3] and the highest level is (86.3, 117]. We can also see which level each row falls into, the first two rows being in the low level for <code>hdl</code>, the third row being in the middle level and so on.</p>
<p>We can then add this as a new factor variable, <code>hdl_level</code>, and represent each level with the labels <code>"low"</code>, <code>"mid"</code> and <code>"high"</code> using the code below.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data.html#cb59-1" tabindex="-1"></a>chol_full<span class="sc">$</span>hdl_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">cut</span>(<span class="at">x =</span> chol_full<span class="sc">$</span>hdl, <span class="at">breaks =</span> <span class="dv">3</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>),</span>
<span id="cb59-2"><a href="data.html#cb59-2" tabindex="-1"></a>                              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb59-3"><a href="data.html#cb59-3" tabindex="-1"></a></span>
<span id="cb59-4"><a href="data.html#cb59-4" tabindex="-1"></a><span class="fu">head</span>(chol_full)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
ldl
</th>
<th style="text-align:right;">
hdl
</th>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
height
</th>
<th style="text-align:right;">
bmi
</th>
<th style="text-align:left;">
hdl_level
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P912
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
90.77
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
31.78110
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
P215
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
75.06
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:right;">
24.50939
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
P063
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
73.99
</td>
<td style="text-align:right;">
1.84
</td>
<td style="text-align:right;">
21.85432
</td>
<td style="text-align:left;">
mid
</td>
</tr>
<tr>
<td style="text-align:left;">
P117
</td>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
86.25
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:right;">
25.75473
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
P613
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
76.95
</td>
<td style="text-align:right;">
1.81
</td>
<td style="text-align:right;">
23.48829
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
P332
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
57.66
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:right;">
18.82776
</td>
<td style="text-align:left;">
low
</td>
</tr>
</tbody>
</table>
</div>
<hr />
<p>Sections <a href="https://read.kortext.com/reader/pdf/92741/54">1.11.2 Creating New Variables in a Data Frame</a> and <a href="https://read.kortext.com/reader/pdf/92741/62">1.13 Tables</a> of <em>Probability and Statistics with R</em> describe how to create new variables.</p>
</div>
<div id="merging-data-frames" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Merging data frames<a href="data.html#merging-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes information relating to the same subjects or observations might be stored in two separate data frames. When this is the case it is easy to combine two data frames using the <code>merge()</code> function. <code>merge()</code> takes the following arguments:</p>
<ul>
<li><code>x =</code>: this is the first of the two data frames you want to merge together.</li>
<li><code>y =</code>: this is the second of the two data frames you want to merge.</li>
<li><code>by.x =</code>: this specifies which column in the first data frame should be used to merge. This is usually an identifying variable such as subjects' names or ID codes.</li>
<li><code>by.y =</code>: this specifies which column in the second data frame should be used to merge.</li>
<li><code>all =</code>: this takes values <code>TRUE</code> or <code>FALSE</code>, indicating whether all rows from both data frames should be included.</li>
<li><code>all.x =</code>: this takes values <code>TRUE</code> and <code>FALSE</code>, indicating whether extra rows should be created in the second data frame so that all rows in the first data frame are kept.</li>
<li><code>all.y =</code>: this takes values <code>TRUE</code> and <code>FALSE</code>, indicating whether extra rows should be created in the first data frame so that all rows in the second data frame are kept.</li>
</ul>
<p>Only the arguments <code>x =</code> and <code>y =</code> are required. When any of of the <code>by. =</code> arguments are left out of the function, R will automatically look for columns which share the same name in the two data sets. When any of the <code>all. =</code> arguments are left out, they default to <code>FALSE</code>, so only complete cases are kept in the final merged data frame.</p>
<p>The file <em>treatment.csv</em> contains information on whether patients in a study testing a new treatment for high cholesterol were given the new drug or a placebo drug with no effect. Some of the patients in this new study are subjects from the <code>chol</code> data frame. We can read in the file <em>treatment.csv</em> and merge it with <code>chol_full</code> in order to see all the information available on a subject.</p>
<p>To start with, we need to read in <em>treatment.csv</em> and save this as a data frame called <code>treatment</code>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="data.html#cb60-1" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;treatment.csv&quot;</span>)</span></code></pre></div>
<p>Then we can merge <code>chol_full</code> and <code>treatment</code> into a single data frame called <code>patients</code> using the following code.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data.html#cb61-1" tabindex="-1"></a>patients <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> chol_full, <span class="at">y =</span> treatment, <span class="at">by.x =</span> <span class="st">&quot;id&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;patient_id&quot;</span>,</span>
<span id="cb61-2"><a href="data.html#cb61-2" tabindex="-1"></a>                  <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-3"><a href="data.html#cb61-3" tabindex="-1"></a><span class="fu">head</span>(patients[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)])</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:right;">
trig
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
smoke
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
height
</th>
<th style="text-align:right;">
bmi
</th>
<th style="text-align:left;">
hdl_level
</th>
<th style="text-align:left;">
treatment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
current
</td>
<td style="text-align:right;">
99.02
</td>
<td style="text-align:right;">
1.70
</td>
<td style="text-align:right;">
34.26298
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
73.99
</td>
<td style="text-align:right;">
1.84
</td>
<td style="text-align:right;">
21.85432
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:left;">
Treatment
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Treatment
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
74.90
</td>
<td style="text-align:right;">
1.61
</td>
<td style="text-align:right;">
28.89549
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:left;">
Treatment
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Treatment
</td>
</tr>
<tr>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
ex-smoker
</td>
<td style="text-align:right;">
86.25
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:right;">
25.75473
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
Placebo
</td>
</tr>
</tbody>
</table>
</div>
<p>Because the column showing the patient ID has a different name in <code>chol_full</code> and <code>treatment</code>, we have had to specify what it is called in each data frame here using <code>by.x =</code> and <code>by.y =</code> (make sure to check the contents of your data frames to notice things like this!). The argument <code>all = TRUE</code> means that we are keeping all information from both data frames, regardless of whether a patient only appears in <code>chol_full</code> or only in <code>treatment</code>. This is why in the excerpt of <code>patients</code> above, there are rows where the value for all variables except <code>treatment</code> are <code>NA</code>.</p>
<div class="webex-box">
<p><strong>The file <em>class.csv</em> contains information on the average primary class size in the years 2016 - 2022. Read this file into R and save it as a data frame called <code>class</code>.</strong></p>
<p><strong>Merge the information from the data frames <code>education</code> and <code>class</code> together into a new data frame called <code>primary</code>, showing all variables from <code>education</code> and the average class size for primary schools only. Look carefully at which row names these two data frames have in common.</strong></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>To read the file <em>class.csv</em> in to R, we can use the following code.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="data.html#cb62-1" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;class.csv&quot;</span>)</span></code></pre></div>
<p>In order to merge the two data frames, we want to use the function <code>merge()</code>. The data frame we provide to the argument <code>x =</code> is <code>education</code> and the data frame for the <code>y =</code> argument is <code>class</code>.</p>
<p>Because we want to match up the rows with the same year and the same level of education, we need to give the argument <code>by =</code> a vector of these two variables. We can use the argument <code>by =</code>, rather than <code>by.x =</code> and <code>by.y =</code>, because the columns have the same names in both data frames.</p>
<p>Finally, since we only want to show the rows for primary schools, we can specify <code>all.y =TRUE</code>. This will keep all the rows from the second data frame, <code>class</code>, and delete the rows from the first data frame which don't have a matching row in the second. For example, because there is no information on the average class size in secondary schools in 2016 in <code>class</code>, this row from <code>education</code> will not appear in <code>primary</code>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data.html#cb63-1" tabindex="-1"></a>primary <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> education, <span class="at">y =</span> class, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;level&quot;</span>), <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-2"><a href="data.html#cb63-2" tabindex="-1"></a>primary</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
schools
</th>
<th style="text-align:right;">
teachers
</th>
<th style="text-align:right;">
pupils
</th>
<th style="text-align:right;">
ratio
</th>
<th style="text-align:right;">
size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2031
</td>
<td style="text-align:right;">
23920
</td>
<td style="text-align:right;">
396697
</td>
<td style="text-align:right;">
16.58432
</td>
<td style="text-align:right;">
23.5
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;">
24477
</td>
<td style="text-align:right;">
400312
</td>
<td style="text-align:right;">
16.35462
</td>
<td style="text-align:right;">
23.5
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
400276
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
23.5
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
25027
</td>
<td style="text-align:right;">
398794
</td>
<td style="text-align:right;">
15.93455
</td>
<td style="text-align:right;">
23.5
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
25651
</td>
<td style="text-align:right;">
393957
</td>
<td style="text-align:right;">
15.35835
</td>
<td style="text-align:right;">
23.1
</td>
</tr>
<tr>
<td style="text-align:left;">
2021
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
25807
</td>
<td style="text-align:right;">
390313
</td>
<td style="text-align:right;">
15.12431
</td>
<td style="text-align:right;">
23.2
</td>
</tr>
<tr>
<td style="text-align:left;">
2022
</td>
<td style="text-align:left;">
Primary
</td>
<td style="text-align:right;">
1994
</td>
<td style="text-align:right;">
25451
</td>
<td style="text-align:right;">
388920
</td>
<td style="text-align:right;">
15.28113
</td>
<td style="text-align:right;">
23.3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr />
<p>For more information on merging data set, see <a href="https://read.kortext.com/reader/pdf/92741/56">Section 1.11.4 Merging Data Frames</a> of <em>Probability and Statistics with R</em>.</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Check Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Check Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="reading.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
