<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Comparing Samples | S2S Lab 4</title>
  <meta name="description" content="3 Comparing Samples | S2S Lab 4" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Comparing Samples | S2S Lab 4" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Comparing Samples | S2S Lab 4" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quant.html"/>
<link rel="next" href="ggplot2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Qualitative Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#sec:tables"><i class="fa fa-check"></i><b>1.1</b> Tables</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#bars"><i class="fa fa-check"></i><b>1.2</b> Barplots</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#sec:dots"><i class="fa fa-check"></i><b>1.3</b> Dot Charts</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#sec:pies"><i class="fa fa-check"></i><b>1.4</b> Pie Charts</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#bi"><i class="fa fa-check"></i><b>1.5</b> Bivariate Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quant.html"><a href="quant.html"><i class="fa fa-check"></i><b>2</b> Quantitative Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quant.html"><a href="quant.html#stem-and-leaf-plots"><i class="fa fa-check"></i><b>2.1</b> Stem and Leaf Plots</a></li>
<li class="chapter" data-level="2.2" data-path="quant.html"><a href="quant.html#strip"><i class="fa fa-check"></i><b>2.2</b> Strip Charts</a></li>
<li class="chapter" data-level="2.3" data-path="quant.html"><a href="quant.html#histograms"><i class="fa fa-check"></i><b>2.3</b> Histograms</a></li>
<li class="chapter" data-level="2.4" data-path="quant.html"><a href="quant.html#kernel-density-estimators"><i class="fa fa-check"></i><b>2.4</b> Kernel Density Estimators</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="comp.html"><a href="comp.html"><i class="fa fa-check"></i><b>3</b> Comparing Samples</a>
<ul>
<li class="chapter" data-level="3.1" data-path="comp.html"><a href="comp.html#qq-plots"><i class="fa fa-check"></i><b>3.1</b> QQ Plots</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> ggplot2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#ggbars"><i class="fa fa-check"></i><b>4.1</b> Barplots</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#gghist"><i class="fa fa-check"></i><b>4.2</b> Histograms</a></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#ggkern"><i class="fa fa-check"></i><b>4.3</b> Kernel Density Estimators</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="further-exercises.html"><a href="further-exercises.html"><i class="fa fa-check"></i><b>5</b> Further Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="further-exercises.html"><a href="further-exercises.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="further-exercises.html"><a href="further-exercises.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">S2S Lab 4</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="comp" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Comparing Samples<a href="comp.html#comp" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In statistical analysis it is common to want to compare two samples from different groups or "populations". When comparing two different groups of data, we might want to answer questions about the properties of the data such as are the centers the same? Are the spreads similar? Do the shapes of the distributions look the same?</p>
<p>In order to answer these questions, graphical methods of presenting the data can be useful such as histograms or density plots.</p>
<p>For example, we might wish to compare the distribution of the BMI of patients who are given the epidural anesthetic in the traditional sitting position with the distribution of the BMI of patients in the hamstring stretch group. In order to do this, we first need to calculate the BMI of all patients in the <code>EPIDURAL</code> data set, since BMI is not one of the variables measured.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="comp.html#cb55-1" aria-hidden="true" tabindex="-1"></a>EPIDURAL<span class="sc">$</span>BMI <span class="ot">&lt;-</span> EPIDURAL<span class="sc">$</span>kg<span class="sc">/</span>(EPIDURAL<span class="sc">$</span>cm<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>Then, in order to make it easier to plot the BMI for the two groups separately, we can create two subsets of the data using the <code>subset()</code> function. The first, <code>BMI_sitting</code>, contains the BMI values for the patients that were given the epidural anesthetic in the traditional sitting position. <code>BMI_hamstring</code> similarly stores BMI values, but for the patients given the anesthetic in the hamstring stretch position.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="comp.html#cb56-1" aria-hidden="true" tabindex="-1"></a>BMI_sitting <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="at">x =</span> EPIDURAL,</span>
<span id="cb56-2"><a href="comp.html#cb56-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subset =</span> (treatment <span class="sc">==</span> <span class="st">&quot;Traditional Sitting&quot;</span>),</span>
<span id="cb56-3"><a href="comp.html#cb56-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">select =</span> BMI)</span>
<span id="cb56-4"><a href="comp.html#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="comp.html#cb56-5" aria-hidden="true" tabindex="-1"></a>BMI_hamstring <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="at">x =</span> EPIDURAL,</span>
<span id="cb56-6"><a href="comp.html#cb56-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">subset =</span> (treatment <span class="sc">==</span> <span class="st">&quot;Hamstring Stretch&quot;</span>),</span>
<span id="cb56-7"><a href="comp.html#cb56-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">select =</span> BMI)</span></code></pre></div>
<p>Finally, we want to actually view the shape of the distributions for the two groups to see if they are similar. We can do this using two separate histograms of BMI. It doesn't make any sense to compare histograms when the bin widths or the units used on the axes are different, so the following code ensures that, for both histograms, the width of each bin is 5 units, the x-axes range from 20 to 60 and the y-axes range from 0 to 17.</p>
<p>The line of code <code>par(mfrow = c(1, 2))</code> is used to view the histograms side by side. This means that plots will be created in a <span class="math inline">\(1\times 2\)</span> grid, so two plots can be seen together. <code>par(mfrow = c(1, 1))</code> sets this back to only one plot being shown at a time.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="comp.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb57-2"><a href="comp.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="comp.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x =</span> BMI_sitting<span class="sc">$</span>BMI,</span>
<span id="cb57-4"><a href="comp.html#cb57-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">20</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb57-5"><a href="comp.html#cb57-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;burlywood&quot;</span>,</span>
<span id="cb57-6"><a href="comp.html#cb57-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">17</span>),</span>
<span id="cb57-7"><a href="comp.html#cb57-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Traditional Sitting Group&quot;</span>,</span>
<span id="cb57-8"><a href="comp.html#cb57-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;BMI&quot;</span>,</span>
<span id="cb57-9"><a href="comp.html#cb57-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb57-10"><a href="comp.html#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="comp.html#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x =</span> BMI_hamstring<span class="sc">$</span>BMI,</span>
<span id="cb57-12"><a href="comp.html#cb57-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">20</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb57-13"><a href="comp.html#cb57-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;burlywood4&quot;</span>,</span>
<span id="cb57-14"><a href="comp.html#cb57-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">17</span>),</span>
<span id="cb57-15"><a href="comp.html#cb57-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Hamstring Stretch Group&quot;</span>,</span>
<span id="cb57-16"><a href="comp.html#cb57-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;BMI&quot;</span>,</span>
<span id="cb57-17"><a href="comp.html#cb57-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb57-18"><a href="comp.html#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="comp.html#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/comp3.2-1.png" width="672" /></p>
<!--We can see from the two histograms that the distribution of BMI for patients in both groups is skewed to the right and both have a mode BMI around 35kg/m^2^. The right-skew seen in the distribution for the hamstring stretch group is slightly more extreme than that seen in the traditional sitting group.-->
<div class="webex-box webex-check">
<p><strong>How would you compare the two distributions shown in the histograms above?</strong></p>
<div id="radio_TWTCIYJKUE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TWTCIYJKUE" value=""></input> <span>Both distributions are skewed to the left.</span></label><label><input type="radio" autocomplete="off" name="radio_TWTCIYJKUE" value="answer"></input> <span>Both distributions are skewed to the right.</span></label><label><input type="radio" autocomplete="off" name="radio_TWTCIYJKUE" value=""></input> <span>The distribution for the traditional sitting group is more extremely skewed than the distribution for the hamstring stretch group.</span></label><label><input type="radio" autocomplete="off" name="radio_TWTCIYJKUE" value="answer"></input> <span>The distribution for the hamstring stretch group is more extremely skewed than the distribution for the traditional sitting group.</span></label><label><input type="radio" autocomplete="off" name="radio_TWTCIYJKUE" value=""></input> <span>The distribution for the traditional sitting group is symmetric whereas the distribution for the hamstring stretch group is skewed.</span></label>
</div>
</div>
<p>Rather than histograms, we may wish to compare the distributions of BMI in these two groups using kernel density estimates. The following code plots the kernel density estimate of the BMI for the traditional sitting group against the estimate of the distribution for the BMI of the hamstring stretch group.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="comp.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="at">x =</span> BMI_sitting<span class="sc">$</span>BMI),</span>
<span id="cb58-2"><a href="comp.html#cb58-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;burlywood&quot;</span>,</span>
<span id="cb58-3"><a href="comp.html#cb58-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb58-4"><a href="comp.html#cb58-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">60</span>),</span>
<span id="cb58-5"><a href="comp.html#cb58-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Kernel Density Estimates of BMI&quot;</span>,</span>
<span id="cb58-6"><a href="comp.html#cb58-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;BMI&quot;</span>)</span>
<span id="cb58-7"><a href="comp.html#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="comp.html#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(<span class="at">x =</span> BMI_hamstring<span class="sc">$</span>BMI),</span>
<span id="cb58-9"><a href="comp.html#cb58-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;burlywood4&quot;</span>,</span>
<span id="cb58-10"><a href="comp.html#cb58-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/comp4-1.png" width="672" /></p>
<p>Again we can see that both distributions are right-skewed, but that the skew for the hamstring stretch group is slightly more extreme.</p>
<div id="qq-plots" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> QQ Plots<a href="comp.html#qq-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A useful plot for assessing whether data is normally distributed is a <strong>normal quantile-quantile (QQ) plot</strong>. This uses the quantiles of the standard normal distribution as the <span class="math inline">\(x\)</span> co-ordinates and the quantiles from the data as the <span class="math inline">\(y\)</span> co-ordinates. If the data of interest follows a normal distribution, then we would expect to see the points lying roughly along a straight line.</p>
<p>Normal QQ plots can be created in R using the function <code>qqnorm()</code>. The only argument this function needs is <code>y =</code> which gives the vector of data we want to check is normally distributed or not.</p>
<p>We can add a straight line to an existing normal QQ plot using the function <code>qqline()</code>, which also takes the same vector of data in the argument <code>y =</code>.</p>
<p>The code below creates side-by-side normal QQ plots comparing the distributions of BMI in the group of patients given the epidural anesthetic in the traditional sitting position and in the hamstring stretch position with a standard normal distribution.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="comp.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb59-2"><a href="comp.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="comp.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="at">y =</span> BMI_sitting<span class="sc">$</span>BMI)</span>
<span id="cb59-4"><a href="comp.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="at">y =</span> BMI_sitting<span class="sc">$</span>BMI)</span>
<span id="cb59-5"><a href="comp.html#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="comp.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="at">y =</span> BMI_hamstring<span class="sc">$</span>BMI)</span>
<span id="cb59-7"><a href="comp.html#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="at">y =</span> BMI_hamstring<span class="sc">$</span>BMI)</span>
<span id="cb59-8"><a href="comp.html#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="comp.html#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/comp6-1.png" width="672" /></p>
<p>We can see in both of these QQ plots that the majority of points roughly follow the plotted straight line. For both groups, the higher quantiles in the distribution of BMI start to stray away from this straight line. This is because both these distributions are right-skewed, suggesting they do not follow a normal distribution.</p>
<p>We can again see that the distribution for the hamstring stretch group (the right-hand plot) is more extremely right-skewed than that for the traditional sitting group. This is shown in these plots because the large quantiles stray further from the straight line in the hamstring stretch group than in the traditional sitting group.</p>
<div class="webex-box webex-check">
<p><strong>Create a new subset of the <code>TITANIC3</code> data frame that contains the ages of all passengers who survived the sinking. Plot the quantiles of the distribution of age against the quantiles of a standard normal distribution in a QQ plot.</strong></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="comp.html#cb60-1" aria-hidden="true" tabindex="-1"></a>age_survived <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="at">x =</span> TITANIC3,</span>
<span id="cb60-2"><a href="comp.html#cb60-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">subset =</span> (survived <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb60-3"><a href="comp.html#cb60-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">select =</span> age)</span>
<span id="cb60-4"><a href="comp.html#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="comp.html#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="at">y =</span> age_survived<span class="sc">$</span>age)</span>
<span id="cb60-6"><a href="comp.html#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="at">y =</span> age_survived<span class="sc">$</span>age)</span></code></pre></div>
<p><img src="_main_files/figure-html/comp-ans2-1.png" width="672" /></p>
</div>
<p><strong>Do you think that the ages of passengers who survived the sinking of the Titanic follow a normal distribution?</strong></p>
<p><select class='webex-select'><option value='blank'></option><option value=''>Yes</option><option value='answer'>No</option><option value=''>Can't say</option></select></p>
</div>
<hr />
<p>You can read more about how normal QQ plots are constructed in <a href="https://read.kortext.com/reader/pdf/92741/296">Section 4.3.7 Normal (Gaussian) Distribution</a> in <em>Probability and Statistics with R</em> (specifically <a href="https://read.kortext.com/reader/pdf/92741/301">pages 301-306</a>).</p>
<!-- below introduces qqplot() which compares two separate groups of data, not compares one distribution with the normal distribution -->
<!--
Another useful plot that can help to compare two groups of data is the **quantile-quantile (QQ) plot**. This plots the quantiles of one distribution ($x$ coordinates) against the quantiles of another distribution ($y$ coordinates). If the two distributions are similar, then we would expect to see the points lying roughly along the straight line $y=x$.

The function for creating a QQ plot in R is `qqplot()`. This takes the arguments listed below.

* `x =`: this is the vector of data that makes up the first group for which the quantiles should be plotted.
* `y =`: this is the vector of data that makes up the second group for which the quantiles should be plotted.

The function `qqplot()` can also be provided with arguments that alter the graphical parameters and aesthetic options of the plot including `xlim =`, `ylim =`, `main =`, `xlab =` and `ylab =`.

We can use a QQ plot to compare the distributions of BMI for patients from the `EPIDURAL` data set who were treated in the traditional sitting position, and those who were treated in the hamstring stretch position. The following code first creates two subsets of data using the `subset()` function. These subsets (`BMI_sitting` and `BMI_hamstring`) store the BMI values for patients who were given the epidural anesthetic in the traditional sitting position and the BMI values for patients who were given the same anesthetic but in the hamstring stretch position respectively.

Then the QQ plot showing the quantiles for both of these groups of data is produced using the function `qqplot()`. The limits for the x- and y-axes have been set to have the same limits. The line of code `abline(a = 0, b = 1)` is used to superimpose the line $y=0+1\times x$ (i.e. $y=x$) over the QQ plot. This makes it easy to determine whether the points fall close to this line, so whether the distributions are similar.


```r
BMI_sitting <- subset(x = EPIDURAL,
                      subset = (treatment == "Traditional Sitting"),
                      select = BMI)

BMI_hamstring <- subset(x = EPIDURAL,
                        subset = (treatment == "Hamstring Stretch"),
                        select = BMI)

qqplot(x = BMI_sitting$BMI, y = BMI_hamstring$BMI,
       xlim = c(20, 60), ylim = c(20, 60),
       xlab = "Traditional Sitting",
       ylab = "Hamstring Stretch")

abline(a = 0, b = 1)
```

<img src="_main_files/figure-html/comp7-1.png" width="672" />

This QQ plot suggest that the distribution of BMI for the group of patients in the traditional sitting position group is similar to the distribution of BMI for the group of patients in the hamstring stretch group. We can say this because the points roughly lie along the line $y=x$.
-->

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Check Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Check Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="quant.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
